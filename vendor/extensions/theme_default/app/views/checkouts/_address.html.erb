<div id='billing'>
  <% checkout_form.fields_for :bill_address do |bill_form| %>
    <h2><%= t("billing_address")%></h2>
    <div class="inner">
      <p id="bfname">
        <label for="<%= t("first_name") %>"><%= t("first_name") %></label>
        <%= bill_form.text_field :firstname, :class => 'required' -%><span class="req">*</span>
      </p>
      <p id="blname">
        <label for="<%= t("last_name") %>"><%= t("last_name") %></label>
        <%= bill_form.text_field :lastname, :class => 'required' -%><span class="req">*</span>
      </p>
      <p id="baddress">
        <label for="<%= t("street_address") %>"><%= t("street_address") %></label>
        <%= bill_form.text_field :address1, :class => 'required' -%><span class="req">*</span>
      </p>
      <p id="baddress2">
        <label for="<%= t("street_address_2") %>"><%= t("street_address_2") %></label>
        <%= bill_form.text_field :address2 %>
      </p>
      <p id="bcity">
        <label for="<%= t("city") %>"><%= t("city") %></label>
        <%= bill_form.text_field :city, :class => 'required' -%><span class="req">*</span>
      </p>                        
      <% if Spree::Config[:address_requires_state] %>
        <p>
          <label for="<%= t("state") %>"><%= t("state") %></label>
          <span id="bstate">
            <% if @checkout.bill_address.country.states.empty? %>
              <%= bill_form.text_field :state_name, :class => 'required' -%>
            <% else %>
              <%= bill_form.collection_select( 
                                    :state_id, 
                                    @states, 
                                    :id, 
                                    :name, 
                                    {:include_blank => true}, 
                                    {:style=> 'width:150px;'}) %>
            <% end %>
          </span>
          <span class="req">*</span>
        </p>
      <% end %>
      <p id="bzip">
        <label for="<%= t("zip") %>"><%= t("zip") %></label>
        <%= bill_form.text_field :zipcode, :class => 'required' -%><span class="req">*</span>
      </p>    
      <p id="bcountry">
        <label for="<%= t("country") %>"><%= t("country") %></label>
        <span id="bcountry"><%= bill_form.collection_select :country_id, @countries, :id, :name, {}, {:style => 'width:150px;', :class => 'required'} %></span>
      </p>
      <p id="bphone">
        <label for="<%= t("phone") %>"><%= t("phone") %></label>
        <%= bill_form.text_field :phone, :class => 'required' -%><span class="req">*</span>
          </p>
          <% if Spree::Config[:alternative_billing_phone] %>
            <p id="baltphone">
              <label for=""><%= t("alternative_phone") %></label>
              <%= bill_form.text_field :alternative_phone -%>
            </p>
          <% end %>
      </p>
    </div>
  <% end %>
</div>
<div id='shipping'>
  <% checkout_form.fields_for :shipment do |shipment| %>     
    <% shipment.fields_for :address do |address| %>
      <h2><%= t("shipping_address")%></h2>
    	<p>
    	  <label for="checkout_same_address" id="use_billing"><%= t("use_billing_address") %></label>
    	  <%= check_box_tag 'checkout[use_billing]', '1', @checkout.use_billing %>
    	</p> 
      <div class="inner">
      	<p id="sfname">
      		<label for="<%= t("first_name") %>"><%= t("first_name") %></label>
      		<%= address.text_field :firstname, :class => 'required' -%><span class="req">*</span>
      	</p>
      	<p id="slname">
      		<label for="<%= t("last_name") %>"><%= t("last_name") %></label>
      		<%= address.text_field :lastname, :class => 'required' -%><span class="req">*</span>
      	</p>
      	<p id="saddress">
      		<label for="<%= t("street_address") %>"><%= t("street_address") %></label>
      		<%= address.text_field :address1, :class => 'required' -%><span class="req">*</span>
      	</p>
      	<p id="saddress2">
      		<label for="<%= t("street_address_2") %>"><%= t("street_address_2") %></label>
      		<%= address.text_field :address2 %>
      	</p>
      	<p id="scity">
      		<label for="<%= t("city") %>"><%= t("city") %></label>
      		<%= address.text_field :city, :class => 'required' -%><span class="req">*</span>
      	</p>    
          <% if Spree::Config[:address_requires_state] %>
            <p>
              <label for="<%= t("state") %>"><%= t("state") %></label>
              <span id="sstate">
                <% if @checkout.shipment.address.state.present? %>
      		<%= address.collection_select(:state_id, 
                                        @states, 
                                        :id, 
                                        :name, 
                                        {:include_blank => true}, 
                                        {:style=> 'width:150px;'}) %>
                <% else %>
                  <%= address.text_field :state_name, :class => 'required' -%>
                <% end %>
              </span>
              <span class="req">*</span>
            </p>
          <% end %>
      	<p id="szip">
      		<label for="<%=t ("zip") %>"><%= t("zip") %></label>
      		<%= address.text_field :zipcode, :class => 'required' -%><span class="req">*</span>
      	</p>
      	<p id="scountry">
      		<label for="<%= t("country") %>"><%= t("country") %></label>
      		<span id="scountry"><%= address.collection_select :country_id, @shipping_countries, :id, :name, {}, {:style => 'width:150px;', :class => 'required'} %></span>
      	</p>
      	<p id="sphone">
      		<label for="<%= t("phone") %>"><%= t("phone") %></label>
      		<%= address.text_field :phone, :class => 'required' -%><span class="req">*</span>
      	</p>
      	<% if Spree::Config[:alternative_shipping_phone] %>
          <p id="saltphone">
            <label for=""><%= t("alternative_phone") %></label>
            <%= address.text_field :alternative_phone -%>
          </p>
        <% end %>
      </div>
      <div class="form-buttons">
        <input type="submit" class="continue button primary" value="<%=t("save_and_continue") %>"/>
      </div>
    <% end %>
  <% end %>
</div>